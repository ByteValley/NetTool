#!name=ç•ªèŒ„å»å¹¿å‘Š
#!desc=é›†æˆ Lookahead å‰ç»è§„åˆ™ä¸å¸¸è§„ DOMAIN/URL-REGEX æ‹¦æˆªï¼Œå½»åº•å±è”½ç•ªèŒ„å°è¯´å¼€å±ã€ç« æœ«ã€è´´ç‰‡ã€å¬ä¹¦é¡µå¹¿å‘ŠåŠæ‚¬æµ®ç¦åˆ©æ ‡ç­¾ï¼Œä¿ç•™å°é¢/å¤´åƒå’Œå­—èŠ‚ç³»æ ¸å¿ƒåŠŸèƒ½ã€‚
#!author=å¯è‰ğŸ…¥ & zqzess & ChatGPT
#!icon=https://raw.githubusercontent.com/luestr/IconResource/main/App_icon/120px/DragonRead.png
#!category=å¹¿å‘Šå±è”½

[Rule]
# â€”â€” åŸå§‹åŸºç¡€è§„åˆ™ â€”â€”
URL-REGEX,^http://sf3-be-pack\.pglstatp-toutiao\.com/obj/ad-app-package/,REJECT
URL-REGEX,^https://(api-access\.pangolin-sdk-toutiao(\d|-b)?|is\.snssdk)\.com/api/ad/union/sdk/get_ads, DIRECT // æ”¾è¡Œæ­¤æ¡ä»¥ç¡®ä¿å­—èŠ‚è·³åŠ¨å»å¹¿å‘Šè„šæœ¬çš„æ­£å¸¸æ‰§è¡Œ

# â€”â€” Lookahead å¤åˆæ¡ä»¶ ï¼ˆç”± Loon AND è§„åˆ™è½¬æ¢ï¼‰ â€”â€”
URL-REGEX,(?i)(?=.*-ad-)(?=.*\.byteimg\.com).+,REJECT
URL-REGEX,(?i)(?=.*-ttam-)(?=.*\.ibyteimg\.com).+,REJECT
URL-REGEX,(?i)(?=.*ssdk-)(?=.*\.pangle\.io).+,REJECT
URL-REGEX,(?i)(?=.*pangolin)(?=.*\.sgsnssdk\.com).+,REJECT
URL-REGEX,(?i)(?=.*\blf)(?=.*-short\.bytetos\.com).+,REJECT
URL-REGEX,(?i)(?=.*\bv)(?=.*-be-pack\.pglstatp-toutiao\.com).+,REJECT
URL-REGEX,(?i)(?=.*\bsf)(?=.*-be-pack\.pglstatp-toutiao\.com).+,REJECT
URL-REGEX,(?i)(?=.*\bs)(?=.*-fe-scm\.pglstatp-toutiao\.com).+,REJECT
URL-REGEX,(?i)(?=.*\bsf)(?=.*-ttcdn-tos\.pstatp\.com).+,REJECT
URL-REGEX,(?i)(?=.*\bsf)(?=.*-fe-tos\.pglstatp-toutiao\.com).+,REJECT
URL-REGEX,(?i)(?=.*\bsf)(?=.*-static\.i18n-pglstatp\.com).+,REJECT
URL-REGEX,(?i)(?=.*\bif)(?=.*-cdn-tos\.bytescm\.com).+,REJECT
URL-REGEX,(?i)(?=.*\bif)(?=.*-analytics\.bytescm\.com).+,REJECT
URL-REGEX,(?i)(?=.*\blf)(?=.*-analytics\.bytescm\.com).+,REJECT
URL-REGEX,(?i)(?=.*ads)(?=.*normal)(?=.*zijieapi\.com).+,REJECT
URL-REGEX,(?i)(?=.*api)(?=.*-access-)(?=.*\.pangle\.io).+,REJECT
URL-REGEX,(?i)(?=.*api)(?=.*-log-)(?=.*\.pangle\.io).+,REJECT
URL-REGEX,(?i)(?=.*api)(?=.*-dual-event-)(?=.*\.pangle\.io).+,REJECT
URL-REGEX,(?i)(?=.*api)(?=.*pangolin)(?=.*\.sgsnssdk\.com).+,REJECT
URL-REGEX,(?i)(?=.*ads)(?=.*-normal-lq)(?=.*zijieapi\.com).+,REJECT

# â€”â€” å¸¸è§„ DOMAIN æ‹¦æˆª â€”â€”
DOMAIN, dig.bdurl.net, REJECT
DOMAIN, dig.zjurl.cn, REJECT
DOMAIN, log5-applog.fqnovel.com, REJECT
DOMAIN, rtlog5-applog.fqnovel.com, REJECT
DOMAIN, vas-lf-x.snssdk.com, REJECT
DOMAIN,mon.zijieapi.com,REJECT
DOMAIN,lf-ad-ies.bytecdn.cn,REJECT
DOMAIN,i.snssdk.com,REJECT
DOMAIN,is.snssdk.com,REJECT
DOMAIN,bds.snssdk.com,REJECT
DOMAIN,dm.bytedance.com,REJECT
DOMAIN,dm.pstatp.com,REJECT
DOMAIN,dm.toutiao.com,REJECT
DOMAIN,log.snssdk.com,REJECT
DOMAIN,s3a.pstatp.com,REJECT
DOMAIN,sdfp.snssdk.com,REJECT
DOMAIN,tosv.boe.byted.org,REJECT
DOMAIN,tosv.byted.org,REJECT
DOMAIN,extlog.snssdk.com,REJECT
DOMAIN,mssdk-bu.bytedance.com,REJECT
DOMAIN,toblog.ctobsnssdk.com,REJECT
DOMAIN,mssdk.volces.com,REJECT
DOMAIN,pangolin.snssdk.com,REJECT
DOMAIN,gromore.pangolin-sdk-toutiao.com,REJECT
DOMAIN,ether-pack.pangolin-sdk-toutiao.com,REJECT
DOMAIN-KEYWORD,-ad-sign.byteimg.com,REJECT
DOMAIN-KEYWORD,api-access.pangolin-sdk-toutiao,REJECT
DOMAIN-KEYWORD,log-api.pangolin-sdk-toutiao,REJECT
DOMAIN-KEYWORD,-ad.byteoversea.com,REJECT
DOMAIN-KEYWORD,video-cn.snssdk.com,REJECT
DOMAIN-KEYWORD,asiad.byteactivity,REJECT
DOMAIN-REGEX,^v\d+-reading-video\.fqnovelvod\.com$,REJECT
# å±è”½æ‰€æœ‰ä»¥ lf*-cdn-tos.bytegoofy.com ç»“æ„çš„è¯·æ±‚
DOMAIN-REGEX,^lf\d+-cdn-tos\.bytegoofy\.com$,REJECT

# â€”â€” è§†é¢‘ & å›¾åƒå¹¿å‘Š â€”â€”
DOMAIN-REGEX,^v\d+-(reading-video|novelapp)\.fqnovelvod\.com$,REJECT
URL-REGEX,^https?://v\d+-(reading-video|novelapp)\.fqnovelvod\.com/.+\.mp4,REJECT
DOMAIN,lf-reward-video.bytedcdn.com,REJECT

# â€”â€” ç²¾å‡†å›¾åƒå¹¿å‘Š â€”â€”
DOMAIN,p3-ad-sign.byteimg.com,REJECT
DOMAIN,p3-reading-sign.fqnovelpic.com,REJECT
DOMAIN,lf3-reading.fqnovelpic.com,REJECT
DOMAIN,lf-fe.fqnovelstatic.com,REJECT
DOMAIN-KEYWORD,novel.byteimg.com,REJECT
URL-REGEX,^https?://.+\.byteimg\.com/.+(ad|ad-img|ad-pattern).+\.jpeg,REJECT
URL-REGEX,^https?://.+\.byteimg\.com/.+/ad-pattern/.+,REJECT
URL-REGEX,^https?://.+\.fqnovelpic\.com/.+/ad/.+,REJECT

# â€”â€” å¹¿å‘Šæ¥å£ & èµ„æºåŒ… â€”â€”
URL-REGEX,^http://sf3-be-pack\.pglstatp-toutiao\.com/obj/ad-app-package/,REJECT
URL-REGEX,^https?://(api-access\.pangolin-sdk-toutiao(\d|-b)?|is\.snssdk)\.com/api/ad/union/sdk/(get_ads|stats|settings)/,REJECT
URL-REGEX,^https?://.+\.(pglstatp-toutiao|pstatp)\.com/(obj|img)/(ad-app-package|ad|web\.business\.image)/.+,REJECT

# â€”â€” ç”µå•† & åˆ†æ â€”â€”
# â€”â€” ç²¾ç®€ç‰ˆï¼šæ‹¦æ‰€æœ‰ â€œ-lfâ€ å­åŸŸ â€”â€”
DOMAIN-REGEX,^[^.]+-lf\.(zijieapi\.com|ecombdapi\.com|fqnovel\.com|zijieapi\.com)$,REJECT
# â€”â€” ç²¾ç®€ç‰ˆï¼šæ‹¦å¸¦ sinfonlinec çš„ fqnovel åŸŸ â€”â€”
DOMAIN-REGEX,^.+sinfonlinec\.fqnovel\.com$,REJECT
# â€”â€” ä¿ç•™å‡ ä¸ªå•ç‹¬çš„é›¶æ•£åŸŸå â€”â€”
DOMAIN,ma.zijieapi.com,REJECT
DOMAIN,vas.snssdk.com,REJECT
DOMAIN,effect.snssdk.com,REJECT
DOMAIN,pitaya.bytedance.com,REJECT
DOMAIN-KEYWORD,zijieapi.com,REJECT

# â€”â€” ç›´æ’­æµ & è·¨å¹³å° â€”â€”
DOMAIN-KEYWORD,douyincdn.com,REJECT
URL-REGEX,^http://pull-flv-l\d+\.douyincdn\.com/third/stream-.+\.flv,REJECT
DOMAIN,webcast5-open-lf.douyin.com,REJECT
DOMAIN,content-open.douyin.com,REJECT
DOMAIN,p11-sign.douyinpic.com,REJECT
DOMAIN,p26-sign.douyinpic.com,REJECT
DOMAIN-KEYWORD,open.douyin.com,REJECT
# â€”â€” é€šç”¨å…³é”®è¯ & ç»„åˆè¿‡æ»¤ â€”â€”
AND,((DOMAIN-KEYWORD,minigame),(DOMAIN-SUFFIX,zijieapi.com)),REJECT
AND,((DOMAIN-KEYWORD,tnc),(AND,((OR,((DOMAIN-KEYWORD,-bjlgy),(DOMAIN-KEYWORD,-alisc),(DOMAIN-KEYWORD,-aliec))),((OR,((DOMAIN-SUFFIX,snssdk.com),(DOMAIN-SUFFIX,toutiaoapi.com),(DOMAIN-SUFFIX,bytedance.com),(DOMAIN-SUFFIX,zijieapi.com)))))),REJECT

# â€”â€” IPv4 åˆ—è¡¨ â€”â€”
IP-CIDR,47.246.38.0/24,REJECT,no-resolve
IP-CIDR,49.71.37.101/32,REJECT,no-resolve
IP-CIDR,58.251.62.58/32,REJECT,no-resolve
IP-CIDR,61.170.77.65/32,REJECT,no-resolve
IP-CIDR,101.36.166.16/32,REJECT,no-resolve
IP-CIDR,103.136.221.67/32,REJECT,no-resolve
IP-CIDR,106.117.245.59/32,REJECT,no-resolve
IP-CIDR,107.155.58.209/32,REJECT,no-resolve
IP-CIDR,117.71.105.23/32,REJECT,no-resolve
IP-CIDR,117.92.229.188/32,REJECT,no-resolve
IP-CIDR,122.14.230.132/32,REJECT,no-resolve
IP-CIDR,155.102.4.4/32,REJECT,no-resolve
IP-CIDR,155.102.4.6/32,REJECT,no-resolve
IP-CIDR,155.102.4.142/32,REJECT,no-resolve
IP-CIDR,155.102.4.146/32,REJECT,no-resolve
IP-CIDR,163.181.35.180/32,REJECT,no-resolve
IP-CIDR,163.181.35.184/32,REJECT,no-resolve
IP-CIDR,163.181.35.203/32,REJECT,no-resolve
IP-CIDR,163.181.228.147/32,REJECT,no-resolve
IP-CIDR,180.96.2.114/32,REJECT,no-resolve
IP-CIDR,218.12.77.96/32,REJECT,no-resolve
IP-CIDR,218.94.207.205/32,REJECT,no-resolve

# â€”â€” IPv6 åˆ—è¡¨ â€”â€”
IP-CIDR,2404:2280:109:0:3::19/128,REJECT,no-resolve
IP-CIDR,2408:8756:2cff:e410:5e::10/128,REJECT,no-resolve
IP-CIDR,2408:871a:6010:302::1:13a/128,REJECT,no-resolve

[URL Rewrite]
^https://sf3-fe-tos\.pglstatp-toutiao\.com/obj/ad-pattern/ reject header
^https://sf3-fe-tos\.pglstatp-toutiao\.com/obj/ad-pattern/ reject
^https://lf-cdn-tos\.bytescm\.com/obj/static/ad/ reject

[MITM]
hostname = %APPEND% \
  *.snssdk.com,*.pstatp.com,*.pglstatp-toutiao.com,*.byteimg.com,*.zijieapi.com, \
  *.pangle.io,*.ibyteimg.com,*.pangolin-sdk-toutiao,*.fqnovelvod.com,*.fqnovelpic.com, \
  *.fqnovelstatic.com,*.ecombdapi.com,*.bytedcdn.com,*.douyincdn.com,*.douyin.com, \
  *.bytegecko.com,*.bytedance.com,gurd.snssdk.com,adim.pinduoduo.com

