#!name=番茄去广告
#!author=ByteValley & ChatGPT
#!desc=移除番茄小说开屏／贴片／听书／图像／视频广告，保留封面、头像及核心功能（预约／签到／催更／书城／短剧）。
#!icon=https://raw.githubusercontent.com/luestr/IconResource/main/App_icon/120px/DragonRead.png
#!category=广告屏蔽

[Rule]
# ——— 1. 放行业务接口：预约／签到／催更 ———
URL-REGEX,^https://api-access\.pangolin-sdk-toutiao(?:\d|-b)?\.com/api/book/(reserve_info|reserve),DIRECT
URL-REGEX,^https://api-access\.pangolin-sdk-toutiao(?:\d|-b)?\.com/api/book/(sign_info|get_sign_info),DIRECT
URL-REGEX,^https://api-access\.pangolin-sdk-toutiao(?:\d|-b)?\.com/api/book/sign$,DIRECT
URL-REGEX,^https://api-access\.pangolin-sdk-toutiao(?:\d|-b)?\.com/api/(?:book|novel|article)/urge,DIRECT

# ——— 2. 放行封面 & 头像 ———
URL-REGEX,^https?://p\d+-reading-sign\.fqnovelpic\.com/(?:novel-pic|avatar|user-avatar|author-avatar)/,DIRECT

# ——— 3. 激励／联盟广告 SDK ———
URL-REGEX,^https?://(api-access\.pangolin-sdk-toutiao(?:\d|-b)?|is\.snssdk)\.com/api/ad/union/sdk/get_ads,DIRECT
URL-REGEX,^https?://.+\.pangolin-sdk-toutiao.*?/api/ad/union/sdk/(get_ads|stats|settings)/,REJECT

# ——— 4. 视频广告 ———
AND, ((DOMAIN-KEYWORD, reading-video), (DOMAIN-SUFFIX, fqnovelvod.com)),REJECT
AND, ((DOMAIN-KEYWORD, novelapp), (DOMAIN-SUFFIX, fqnovelvod.com)),REJECT
URL-REGEX,^https?://v\d+-novelapp\.fqnovelvod\.com/.+/video/.+,REJECT

# ——— 5. 图像广告 & 奖励视频 —— 
AND, ((DOMAIN-KEYWORD, bytednsdoc), (DOMAIN-SUFFIX, bytednsdoc.com)),REJECT  # lf3-static.bytednsdoc.com
AND, (OR, ((DOMAIN-KEYWORD, luckycat), (DOMAIN-KEYWORD, ad-sign), (DOMAIN-KEYWORD, novel)), (DOMAIN-SUFFIX, byteimg.com)), REJECT  # byteimg.com
AND, ((DOMAIN-KEYWORD, sign), (DOMAIN-SUFFIX, douyinpic.com)), REJECT  # p*-sign.douyinpic.com
AND, ((DOMAIN-KEYWORD, -open), (DOMAIN-SUFFIX, douyin.com)), REJECT  # p*-sign.douyinpic.com
AND, ((DOMAIN-KEYWORD, -lf), OR, ((DOMAIN-SUFFIX, ecombdimg.com), (DOMAIN-SUFFIX, ecombdapi.com))), REJECT  # *.ecombdimg.com

# ——— 6. 短链／跳转跟踪 ———
DOMAIN, dig.zjurl.cn,REJECT

# ——— 其余保留：头条样式伪装 & 章末广告 ——  
[URL Rewrite]
^https:\/\/sf3-fe-tos\.pglstatp-toutiao\.com\/obj\/ad-pattern\/ reject header
^https:\/\/sf3-fe-tos\.pglstatp-toutiao\.com\/obj\/ad-pattern\/ reject
^https:\/\/lf-cdn-tos\.bytescm\.com\/obj\/static\/ad\/ reject
^https:\/\/tnc3-alisc1\.zijieapi\.com\/get_domains\/ reject
^https?:\/\/.+\.pangolin-sdk-toutiao\.com\/api\/ad\/union\/sdk\/(get_ads|stats|settings)\/ - reject
^https?:\/\/.+\.pglstatp-toutiao\.com\/.+\/toutiao\.mp4 - reject
^https?:\/\/.+\.(pglstatp-toutiao|pstatp)\.com\/(obj|img)\/(ad-app-package|ad|web\.business\.image)\/.+ - reject
^https?:\/\/gurd\.snssdk\.com\/src\/server\/v3\/package - reject

[MITM]
hostname = sf3-fe-tos.pglstatp-toutiao.com,lf-cdn-tos.bytescm.com,tnc3-alisc1.zijieapi.com
